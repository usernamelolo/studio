<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GROK ADULT STUDIO 2.0 ‚Ä¢ –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è –≤–∑—Ä–æ—Å–ª—ã—Ö</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background: #f8fafc; font-family: system-ui; }
    .header { background: linear-gradient(90deg, #4f46e5, #7c3aed); }
    .tab-active { background: #4f46e5; color: white; font-weight: 700; }
    .card { background: white; border: 2px solid #e0e7ff; box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.05); }
    video, img { border-radius: 16px; box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1); }
  </style>
</head>
<body class="text-gray-900 min-h-screen pb-20">
  <div class="max-w-7xl mx-auto p-6">
    <header class="header text-white text-center py-16 rounded-3xl mb-12">
      <h1 class="text-6xl font-bold tracking-tight">GROK ADULT STUDIO</h1>
      <p class="text-3xl mt-4">–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –≤–∏–¥–µ–æ –¥–ª—è –≤–∑—Ä–æ—Å–ª—ã—Ö ‚Ä¢ 2026</p>
      <p class="mt-3 text-indigo-100 text-xl">–í—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç ‚Ä¢ –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –º–æ–¥–µ–ª–∏ ‚Ä¢ –ü–æ–ª–Ω–∞—è —Ç–≤–æ—Ä—á–µ—Å–∫–∞—è —Å–≤–æ–±–æ–¥–∞</p>
    </header>

    <!-- –¢–ê–ë–´ -->
    <div class="flex justify-center mb-10 border-b-4 border-indigo-200">
      <button onclick="switchTab(0)" id="tab0" class="tab-active px-14 py-5 text-2xl rounded-t-3xl">üé• –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≤–∏–¥–µ–æ</button>
      <button onclick="switchTab(1)" id="tab1" class="px-14 py-5 text-2xl rounded-t-3xl">üñºÔ∏è –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä</button>
    </div>

    <!-- –í–ò–î–ï–û –°–ï–ö–¶–ò–Ø -->
    <div id="section-video" class="card p-10 rounded-3xl">
      <h2 class="text-4xl font-semibold mb-8 text-indigo-700">üé• –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≤–∏–¥–µ–æ</h2>
      <div class="grid md:grid-cols-2 gap-10">
        <div>
          <h3 class="text-2xl font-medium mb-4">–° —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è</h3>
          <textarea id="video-prompt" rows="5" class="w-full border-2 border-indigo-200 rounded-2xl p-6 text-lg focus:border-indigo-500" placeholder="–ú–æ–ª–æ–¥–∞—è –∂–µ–Ω—â–∏–Ω–∞ –≤ —Å—Ç—É–¥–∏–∏, —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è —Å—Ü–µ–Ω–∞, –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ..."></textarea>
          <div class="mt-6 grid grid-cols-3 gap-4">
            <div><label class="block text-sm mb-1 text-gray-600">–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</label><select id="duration" class="w-full border border-indigo-200 rounded-xl p-3"><option value="8">8 —Å–µ–∫—É–Ω–¥</option><option value="10" selected>10 —Å–µ–∫—É–Ω–¥</option><option value="15">15 —Å–µ–∫—É–Ω–¥</option></select></div>
            <div><label class="block text-sm mb-1 text-gray-600">–§–æ—Ä–º–∞—Ç</label><select id="aspect" class="w-full border border-indigo-200 rounded-xl p-3"><option value="16:9" selected>16:9</option><option value="9:16">9:16</option><option value="1:1">1:1</option></select></div>
            <div><label class="block text-sm mb-1 text-gray-600">–ö–∞—á–µ—Å—Ç–≤–æ</label><select id="resolution" class="w-full border border-indigo-200 rounded-xl p-3"><option value="720p" selected>720p</option><option value="480p">480p</option></select></div>
          </div>
          <button onclick="generateVideo(false)" class="mt-10 w-full bg-indigo-600 hover:bg-indigo-700 text-white text-2xl font-semibold py-7 rounded-3xl transition">–°–æ–∑–¥–∞—Ç—å –≤–∏–¥–µ–æ</button>
        </div>
        <div>
          <h3 class="text-2xl font-medium mb-4">–ò–∑ –≤–∞—à–µ–≥–æ —Ñ–æ—Ç–æ</h3>
          <input type="file" id="video-image-upload" accept="image/*" class="block w-full border-2 border-dashed border-indigo-300 rounded-2xl p-8 text-center cursor-pointer">
          <textarea id="video-image-prompt" rows="4" class="mt-6 w-full border-2 border-indigo-200 rounded-2xl p-6 text-lg" placeholder="–ê–Ω–∏–º–∏—Ä–æ–≤–∞—Ç—å —Å—Ü–µ–Ω—É..."></textarea>
          <button onclick="generateVideo(true)" class="mt-6 w-full bg-indigo-600 hover:bg-indigo-700 text-white text-2xl font-semibold py-7 rounded-3xl transition">–û–∂–∏–≤–∏—Ç—å —Ñ–æ—Ç–æ –≤ –≤–∏–¥–µ–æ</button>
        </div>
      </div>
      <div id="video-result" class="mt-12 hidden">
        <div id="video-status" class="text-center text-xl mb-6 text-gray-700"></div>
        <video id="video-player" controls class="w-full max-w-4xl mx-auto"></video>
        <button onclick="downloadVideo()" class="mt-8 bg-indigo-600 hover:bg-indigo-700 text-white px-12 py-4 rounded-2xl text-lg">–°–∫–∞—á–∞—Ç—å –≤–∏–¥–µ–æ</button>
      </div>
    </div>

    <!-- –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–Ø –°–ï–ö–¶–ò–Ø -->
    <div id="section-image" class="card p-10 rounded-3xl hidden">
      <h2 class="text-4xl font-semibold mb-8 text-indigo-700">üñºÔ∏è –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</h2>
      <div class="grid lg:grid-cols-2 gap-10">
        <div>
          <h3 class="text-2xl font-medium mb-4">–°–æ–∑–¥–∞—Ç—å —Å –Ω—É–ª—è</h3>
          <textarea id="image-prompt" rows="7" class="w-full border-2 border-indigo-200 rounded-2xl p-6 text-lg focus:border-indigo-500" placeholder="–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è –º–æ–ª–æ–¥–∞—è –∂–µ–Ω—â–∏–Ω–∞, —Å—Ç—É–¥–∏–π–Ω–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ, –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ..."></textarea>
          <button onclick="generateImages()" class="mt-8 w-full bg-indigo-600 hover:bg-indigo-700 text-white text-2xl font-semibold py-7 rounded-3xl transition">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å 4 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</button>
        </div>
        <div>
          <h3 class="text-2xl font-medium mb-4">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ç–æ</h3>
          <div class="mb-6">
            <p class="text-sm text-gray-600 mb-2">–û—Å–Ω–æ–≤–Ω–æ–µ —Ñ–æ—Ç–æ</p>
            <input type="file" id="main-edit-upload" accept="image/*" class="block w-full border-2 border-dashed border-indigo-300 rounded-2xl p-8 text-center cursor-pointer">
          </div>
          <div class="mb-6">
            <p class="text-sm text-gray-600 mb-2">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å-—Ñ–æ—Ç–æ (–¥–æ 2 —à—Ç.)</p>
            <input type="file" id="extra1" accept="image/*" class="block w-full text-sm mb-3">
            <input type="file" id="extra2" accept="image/*" class="block w-full text-sm">
          </div>
          <textarea id="edit-prompt" rows="4" class="w-full border-2 border-indigo-200 rounded-2xl p-6 text-lg" placeholder="–ò–∑–º–µ–Ω–∏—Ç—å –ø–æ–∑—É, –æ—Å–≤–µ—â–µ–Ω–∏–µ, —Å—Ç–∏–ª—å..."></textarea>
          <button onclick="editImage()" class="mt-8 w-full bg-indigo-600 hover:bg-indigo-700 text-white text-2xl font-semibold py-7 rounded-3xl transition">–ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
        </div>
      </div>
      <div id="image-gallery" class="mt-16 grid grid-cols-2 md:grid-cols-4 gap-6"></div>
    </div>
  </div>

  <script>
    const API_BASE = "/api/proxy";

    let currentTab = 0;
    function switchTab(n) {
      currentTab = n;
      document.getElementById('section-video').classList.toggle('hidden', n !== 0);
      document.getElementById('section-image').classList.toggle('hidden', n !== 1);
      document.getElementById('tab0').classList.toggle('tab-active', n === 0);
      document.getElementById('tab1').classList.toggle('tab-active', n === 1);
    }

    let currentVideoUrl = '';

    async function apiFetch(endpoint, options = {}) {
      const res = await fetch(API_BASE + endpoint, {
        ...options,
        headers: { ...options.headers, 'Content-Type': 'application/json' }
      });
      return res;
    }

    async function fileToBase64(file) {
      return new Promise(resolve => {
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result);
        reader.readAsDataURL(file);
      });
    }

    // ====================== –í–ò–î–ï–û ======================
    async function generateVideo(isImageToVideo) {
      const statusEl = document.getElementById('video-status');
      const resultDiv = document.getElementById('video-result');
      resultDiv.classList.remove('hidden');
      statusEl.textContent = '–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∏–¥–µ–æ... (20‚Äì60 —Å–µ–∫—É–Ω–¥)';

      try {
        let body = {
          model: "grok-imagine-video",
          prompt: isImageToVideo ? document.getElementById('video-image-prompt').value : document.getElementById('video-prompt').value,
          duration: parseInt(document.getElementById('duration').value),
          aspect_ratio: document.getElementById('aspect').value,
          resolution: document.getElementById('resolution').value,
          seed: Math.floor(Math.random() * 2147483647)
        };

        if (isImageToVideo) {
          const file = document.getElementById('video-image-upload').files[0];
          if (!file) return alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ');
          body.image = { url: await fileToBase64(file) };
        }

        const res = await apiFetch('/v1/videos/generations', { method: 'POST', body: JSON.stringify(body) });
        const data = await res.json();
        if (!res.ok) throw new Error(data.error?.message || '–û—à–∏–±–∫–∞');

        const requestId = data.request_id || data.id;
        let attempts = 0;
        const poll = setInterval(async () => {
          attempts++;
          const statusRes = await apiFetch(`/v1/videos/${requestId}`);
          const statusData = await statusRes.json();

          if (statusData.status === 'done') {
            clearInterval(poll);
            currentVideoUrl = statusData.video.url;
            document.getElementById('video-player').src = currentVideoUrl;
            statusEl.textContent = '–ì–æ—Ç–æ–≤–æ! –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –∏ —Å–∫–∞—á–∞–π—Ç–µ –≤–∏–¥–µ–æ';
          } else if (statusData.status === 'failed' || attempts > 40) {
            clearInterval(poll);
            statusEl.textContent = '–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.';
          }
        }, 4000);
      } catch (e) {
        statusEl.textContent = '–û—à–∏–±–∫–∞: ' + e.message;
        alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å (F12)');
      }
    }

    function downloadVideo() {
      if (!currentVideoUrl) return;
      const a = document.createElement('a');
      a.href = currentVideoUrl;
      a.download = `adult-video-${Date.now()}.mp4`;
      a.click();
    }

    // ====================== –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–Ø ======================
    function displayImages(images) {
      const gallery = document.getElementById('image-gallery');
      gallery.innerHTML = '';
      images.forEach(img => {
        const div = document.createElement('div');
        div.className = 'relative group';
        div.innerHTML = `
          <img src="\( {img.url}" class="w-full cursor-pointer" onclick="window.open(' \){img.url}', '_blank')">
          <button onclick="downloadImage('${img.url}')" class="absolute bottom-4 right-4 bg-white/90 px-6 py-2 rounded-2xl text-sm hover:bg-indigo-600 hover:text-white transition">–°–∫–∞—á–∞—Ç—å</button>
        `;
        gallery.appendChild(div);
      });
    }

    function downloadImage(url) {
      const a = document.createElement('a');
      a.href = url;
      a.download = `adult-image-${Date.now()}.jpg`;
      a.click();
    }

    async function generateImages() {
      const prompt = document.getElementById('image-prompt').value.trim();
      if (!prompt) return alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ');
      try {
        const res = await apiFetch('/v1/images/generations', {
          method: 'POST',
          body: JSON.stringify({
            model: "grok-imagine-image",
            prompt: prompt,
            n: 4,
            response_format: "url",
            seed: Math.floor(Math.random() * 2147483647)
          })
        });
        const data = await res.json();
        if (!res.ok) throw new Error(data.error?.message || '–û—à–∏–±–∫–∞');
        if (data.data) displayImages(data.data);
      } catch (e) {
        alert('–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: ' + e.message);
      }
    }

    async function editImage() {
      const mainFile = document.getElementById('main-edit-upload').files[0];
      if (!mainFile) return alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≥—Ä—É–∑–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω–æ–µ —Ñ–æ—Ç–æ');
      const prompt = document.getElementById('edit-prompt').value || "–°–¥–µ–ª–∞—Ç—å –±–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º, —É–ª—É—á—à–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ";
      try {
        const base64Main = await fileToBase64(mainFile);
        const res = await apiFetch('/v1/images/edits', {
          method: 'POST',
          body: JSON.stringify({
            model: "grok-imagine-image",
            prompt: prompt,
            image: { url: base64Main },
            seed: Math.floor(Math.random() * 2147483647)
          })
        });
        const data = await res.json();
        if (!res.ok) throw new Error(data.error?.message || '–û—à–∏–±–∫–∞');
        if (data.data) displayImages(data.data);
      } catch (e) {
        alert('–û—à–∏–±–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: ' + e.message);
      }
    }

    // –°—Ç–∞—Ä—Ç
    switchTab(0);
  </script>
</body>
</html>
